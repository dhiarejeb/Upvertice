<h2 mat-dialog-title>{{ data ? 'Edit' : 'Create' }} Sponsor Offer</h2>

<div mat-dialog-content>
  <form [formGroup]="form" class="grid gap-4">
    <mat-form-field appearance="outline" class="w-full">
      <mat-label>Title</mat-label>
      <input matInput formControlName="title" placeholder="Enter title" />
      <mat-error *ngIf="form.get('title')?.invalid">Title is required</mat-error>
    </mat-form-field>

    <mat-form-field appearance="outline" class="w-full">
      <mat-label>Description</mat-label>
      <textarea matInput formControlName="description" placeholder="Enter description" rows="3"></textarea>
      <mat-error *ngIf="form.get('description')?.invalid">Description is required</mat-error>
    </mat-form-field>

    <mat-form-field appearance="outline" class="w-full">
      <mat-label>Category</mat-label>
      <input matInput formControlName="category" placeholder="Enter category" />
      <mat-error *ngIf="form.get('category')?.invalid">Category is required</mat-error>
    </mat-form-field>

    <div class="grid grid-cols-2 gap-4">
      <mat-form-field appearance="outline">
        <mat-label>Number of Ads</mat-label>
        <input type="number" matInput formControlName="numberAds" placeholder="Enter number of ads" min="1" />
        <mat-error *ngIf="form.get('numberAds')?.invalid">Must be at least 1</mat-error>
      </mat-form-field>

      <mat-form-field appearance="outline">
        <mat-label>Price</mat-label>
        <input type="number" matInput formControlName="price" placeholder="Enter price" min="0" />
        <mat-error *ngIf="form.get('price')?.invalid">Must be a valid price</mat-error>
      </mat-form-field>
    </div>

    <div class="grid grid-cols-2 gap-4">
      <mat-form-field appearance="outline">
        <mat-label>Quantity</mat-label>
        <input type="number" matInput formControlName="productQuantity" placeholder="Enter quantity" min="1" />
        <mat-error *ngIf="form.get('productQuantity')?.invalid">Must be at least 1</mat-error>
      </mat-form-field>

      <mat-form-field appearance="outline">
        <mat-label>Product Type</mat-label>
        <input matInput formControlName="productType" placeholder="Enter product type" />
        <mat-error *ngIf="form.get('productType')?.invalid">Product type is required</mat-error>
      </mat-form-field>
    </div>

    <mat-form-field appearance="outline" class="w-full">
      <mat-label>Sales Area</mat-label>
      <input matInput formControlName="salesArea" placeholder="Enter sales area" />
      <mat-error *ngIf="form.get('salesArea')?.invalid">Sales area is required</mat-error>
    </mat-form-field>

    <mat-form-field appearance="outline" class="w-full">
      <mat-label>Status</mat-label>
      <mat-select formControlName="status">
        <mat-option value="COMING_SOON">COMING SOON</mat-option>
        <mat-option value="AVAILABLE">AVAILABLE</mat-option>
        <mat-option value="CLOSED">CLOSED</mat-option>
      </mat-select>
      <mat-error *ngIf="form.get('status')?.invalid">Status is required</mat-error>
    </mat-form-field>

    <div class="mt-2">
      <label class="block mb-2">Images</label>
      <input type="file" multiple (change)="onFileSelected($event)" class="w-full" />

      <div *ngIf="files.length > 0" class="mt-2">
        <p>Selected files: {{ files.length }}</p>
        <ul class="list-disc pl-5">
          <li *ngFor="let file of files">{{ file.name }} ({{ (file.size / 1024).toFixed(2) }} KB)</li>
        </ul>
      </div>

      <div *ngIf="oldImageUrls.length > 0" class="mt-4">
        <p class="font-semibold mb-2">Previously uploaded images:</p>
        <div class="grid grid-cols-3 gap-4">
          <img
            *ngFor="let url of oldImageUrls"
            [src]="url"
            alt="Old explain image"
            class="w-full h-auto rounded border shadow"
          />
        </div>
      </div>
    </div>
  </form>
</div>

<div mat-dialog-actions align="end">
  <button mat-button (click)="cancel()">Cancel</button>
  <button mat-raised-button color="primary" (click)="submit()" [disabled]="form.invalid">
    {{ data ? 'Update' : 'Create' }}
  </button>
</div>
